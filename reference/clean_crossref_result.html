<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Clean and filter Crossref API results — clean_crossref_result • pubclassify</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Clean and filter Crossref API results — clean_crossref_result"><meta name="description" content="Cleans and filters data frames returned from Crossref API queries. This
function standardizes column names, removes unwanted columns, filters results
based on a search pattern, and cleans JATS-formatted abstracts."><meta property="og:description" content="Cleans and filters data frames returned from Crossref API queries. This
function standardizes column names, removes unwanted columns, filters results
based on a search pattern, and cleans JATS-formatted abstracts."><style>
  /* base font size - slightly larger than 10pt */
  :root {
    font-size: 1rem;
  }

  /* Larger heading sizes for better proportion */
  h1 { font-size: 2.1rem; }
  h2 { font-size: 1.7rem; }
  h3 { font-size: 1.5rem; }
  h4 { font-size: 1.25rem; }

  /* Make main page title bigger and bold */
  .template-home .page-header h1 {
    font-size: 3.2rem;
    font-weight: 700;
  }

  /* Make function page titles bigger and bold */
  .template-reference-topic .page-header h1 {
    font-size: 2.5rem;
    font-weight: 700;
  }

  /* Make vignette titles bigger and bold */
  .template-article .page-header h1 {
    font-size: 2.8rem;
    font-weight: 700;
  }

  /* body text */
  p, li, td, th { font-size: 1rem; }

  /* Make code blocks smaller */
  pre, pre code, .sourceCode { font-size: 0.85rem; }
  code { font-size: 0.9rem; }

  /* other elements */
  .navbar { font-size: 1rem; }
  .nav-pills .nav-link { font-size: 1rem; }
  .ref-index .ref-description { font-size: 1rem; }
  footer { font-size: 1rem; }

  /* column width adjustments */
  @media (min-width: 992px) {
    /* make main content width a bit smaller to allow sidebar to be wider */
    .col-md-9 {
      flex: 0 0 auto;
      width: 85%;
    }

    /* make sidebar wider */
    .col-md-3 {
      flex: 0 0 auto;
      width: 15%;
    }

    /* for reference pages with larger layout */
    .row > .col-xl-8 {
      flex: 0 0 auto;
      width: 85%;
    }

    .row > .col-xl-4 {
      flex: 0 0 auto;
      width: 15%;
    }
  }

  /* Improve sidebar text display */
  .sidebar .list-unstyled li {
    white-space: nowrap;  /* Prevent text wrapping in sidebar links */
    overflow: visible;    /* Allow text to be fully visible */
  }

  /* Make sure citation links don't wrap */
  .sidebar h2 {
    white-space: nowrap;
    overflow: visible;
  }

  /* Fix dropdown menu styling */
  .dropdown-menu {
    background-color: #e2e6ea !important; /* Medium-light gray background - darker than before */
    border: 1px solid rgba(0,0,0,0.15);   /* Add a subtle border */
  }

  .dropdown-item, .dropdown-menu a {
    color: #212529 !important; /* Dark text color (almost black) */
  }

  .dropdown-item:hover, .dropdown-menu a:hover {
    background-color: #cbd3da !important; /* Darker gray on hover */
    color: #000 !important; /* Black text on hover */
  }

  /* Ensure active items are also readable */
  .dropdown-item.active, .dropdown-item:active {
    background-color: #0B2545 !important; /* Your primary color */
    color: white !important;
  }
</style></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pubclassify</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/classify_dwr_pubs.html">DWR Publication Classification using an LLM</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lucy-dwr/pubclassify/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Clean and filter Crossref API results</h1>
      <small class="dont-index">Source: <a href="https://github.com/lucy-dwr/pubclassify/blob/HEAD/R/clean_crossref_result.R" class="external-link"><code>R/clean_crossref_result.R</code></a></small>
      <div class="d-none name"><code>clean_crossref_result.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Cleans and filters data frames returned from Crossref API queries. This
function standardizes column names, removes unwanted columns, filters results
based on a search pattern, and cleans JATS-formatted abstracts.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">clean_crossref_result</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  pattern <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  drop_cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  abstract_col <span class="op">=</span> <span class="st">"abstract"</span>,</span>
<span>  abstract_output_col <span class="op">=</span> <span class="st">"abstract_text"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>A data frame containing Crossref API results.</p></dd>


<dt id="arg-pattern">pattern<a class="anchor" aria-label="anchor" href="#arg-pattern"></a></dt>
<dd><p>Optional character string or regular expression. When provided,
the function will filter the data frame to retain only rows where this pattern
appears in content columns (excluding references). Default is NULL (no filtering).</p></dd>


<dt id="arg-drop-cols">drop_cols<a class="anchor" aria-label="anchor" href="#arg-drop-cols"></a></dt>
<dd><p>Optional character vector of column names to remove from the
data frame. Default is NULL (no columns removed).</p></dd>


<dt id="arg-abstract-col">abstract_col<a class="anchor" aria-label="anchor" href="#arg-abstract-col"></a></dt>
<dd><p>Character string specifying the name of the column containing
abstracts. Default is "abstract".</p></dd>


<dt id="arg-abstract-output-col">abstract_output_col<a class="anchor" aria-label="anchor" href="#arg-abstract-output-col"></a></dt>
<dd><p>Character string specifying the name of the column
where cleaned abstracts will be stored. Default is "abstract_text".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with cleaned column names, filtered rows (if pattern is
provided), and cleaned abstracts.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs several cleaning operations:</p><ol><li><p>Standardizes column names using <code><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">janitor::clean_names()</a></code></p></li>
<li><p>Removes specified columns if <code>drop_cols</code> is provided</p></li>
<li><p>If <code>pattern</code> is provided, filters rows to those containing the pattern in
content fields (excluding references)</p></li>
<li><p>Cleans JATS-formatted abstracts using the <code><a href="clean_jats_abstracts.html">clean_jats_abstracts()</a></code> function</p></li>
</ol><p>The function depends on two helper functions:</p><ul><li><p><code><a href="search_cols.html">search_cols()</a></code>: Searches columns for a pattern and adds a <code>matching_cols</code> column</p></li>
<li><p><code><a href="clean_jats_abstracts.html">clean_jats_abstracts()</a></code>: Extracts and cleans text from JATS-formatted XML abstracts</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># get publications from Crossref</span></span></span>
<span class="r-in"><span><span class="va">crossref_results</span> <span class="op">&lt;-</span> <span class="fu">rcrossref</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rcrossref/reference/cr_works.html" class="external-link">cr_works</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"machine learning"</span>, limit <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># clean the results</span></span></span>
<span class="r-in"><span><span class="va">cleaned_crossref_results</span> <span class="op">&lt;-</span> <span class="fu">clean_crossref_result</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">crossref_results</span><span class="op">$</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  pattern <span class="op">=</span> <span class="st">"neural network"</span>,</span></span>
<span class="r-in"><span>  drop_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"reference"</span>, <span class="st">"container_title_short"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  abstract_col <span class="op">=</span> <span class="st">"abstract"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lucy Andrews.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

